var contentLoaded=function(e,t){var n=!1,r=!0,i=e.document,s=i.documentElement,o="attachEvent",u="detachEvent",a="on",f=function(r){if(r.type=="readystatechange"&&i.readyState!="complete")return;(r.type=="load"?e:i)[u](a+r.type,f,!1),!n&&(n=!0)&&t.call(e,r.type||r)},l=function(){try{s.doScroll("left")}catch(e){setTimeout(l,50);return}f("poll")};if(i.readyState=="complete")t.call(e,"lazy");else{if(i.createEventObject&&s.doScroll){try{r=!e.frameElement}catch(c){}r&&l()}i[o](a+"DOMContentLoaded",f,!1),i[o](a+"readystatechange",f,!1),e[o](a+"load",f,!1)}};define("shim/DOMContentLoaded",function(){}),!window.addEventListener&&function(e,t,n,r,i,s,o,u){t[i]=n[i]=r[i]=function(t,n){if(t=="DOMContentLoaded"&&contentLoaded){contentLoaded(e,n);return}var r=this;u.unshift([r,t,n,function(e){e.currentTarget=r,e.preventDefault=function(){e.returnValue=!1},e.stopPropagation=function(){e.cancelBubble=!0},e.target=e.srcElement||r,n.call(r,e)}]),this.attachEvent("on"+t,u[0][3])},t[s]=n[s]=r[s]=function(e,t){for(var n=0,r;r=u[n];++n)if(r[0]==this&&r[1]==e&&r[2]==t)return this.detachEvent("on"+e,u.splice(n,1)[0][3])},t[o]=n[o]=r[o]=function(e){return this.fireEvent("on"+e.type,e)}}(window,Window.prototype,HTMLDocument.prototype,Element.prototype,"addEventListener","removeEventListener","dispatchEvent",[]),define("shim/addEventListener",function(){}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){for(var n=0,r=this.length;n<r;++n)e.call(t,this[n],n,this)}),define("shim/Array.forEach",function(){}),Array.prototype.filter||(Array.prototype.filter=function(e){"use strict";if(this===void 0||this===null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(typeof e!="function")throw new TypeError;var r=[],i=arguments.length>=2?arguments[1]:void 0;for(var s=0;s<n;s++)if(s in t){var o=t[s];e.call(i,o,s,t)&&r.push(o)}return r}),define("shim/Array.filter",function(){}),Array.prototype.map||(Array.prototype.map=function(e){"use strict";if(this===void 0||this===null)throw new TypeError;var t=Object(this),n=t.length>>>0;if(typeof e!="function")throw new TypeError;var r=new Array(n),i=arguments.length>=2?arguments[1]:void 0;for(var s=0;s<n;s++)s in t&&(r[s]=e.call(i,t[s],s,t));return r}),define("shim/Array.map",function(){}),"indexOf"in Array.prototype||(Array.prototype.indexOf=function(e,t){t===undefined&&(t=0),t<0&&(t+=this.length),t<0&&(t=0);for(var n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1}),define("shim/Array.indexOf",function(){}),Array.isArray||(Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"}),define("shim/Array.isArray",function(){}),Function.prototype.bind||(Function.prototype.bind=function(e){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,r=function(){},i=function(){return n.apply(this instanceof r&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,i.prototype=new r,i}),define("shim/Function.bind",function(){}),Object.create||(Object.create=function(e){function t(){}if(arguments.length>1)throw new Error("Object.create implementation only accepts the first parameter.");return t.prototype=e,new t}),define("shim/Object.create",function(){}),Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(i){if(typeof i!="object"&&typeof i!="function"||i===null)throw new TypeError("Object.keys called on non-object");var s=[];for(var o in i)e.call(i,o)&&s.push(o);if(t)for(var u=0;u<r;u++)e.call(i,n[u])&&s.push(n[u]);return s}}()),define("shim/Object.keys",function(){}),function(e,t){"use strict";var n=1,r={},i={_setEntry:function(e,t){var i=e.__pubSubUID;return i||(i=n++,e.__pubSubUID=i,r[i]={obj:e}),r[i][t]||(r[i][t]=[]),r[i]},_getEntryProp:function(e,t){var n=r[e.__pubSubUID];return n?r[e.__pubSubUID][t]:null},_clearEntry:function(e){var t=r[e.__pubSubUID];if(!t||t.subscriptions&&t.subscriptions.length||t.receivers&&t.receivers.length)return;t.subscriptions=null,t.receivers=null,t.obj=null,delete r[e.__pubSubUID],e.__pubSubUID=null},subscribe:function(e,t,n){var r=this._setEntry(e,"subscriptions"),i=0,s=r.subscriptions,o=s.length,u;for(;i<o;i++){u=s[i];if(u.type===t&&u.fn===n)return}s.push({type:t,fn:n})},unsubscribe:function(e,t,n){var r=this._getEntryProp(e,"subscriptions");if(!r)return;var i=r.length,s;while(--i>=0)s=r[i],s.type===t&&(s.fn===n||!n)&&r.splice(i,1);r.length||this._clearEntry(e)},publishAsync:function(e,t,n){var r=this;setTimeout(function(){r.publish(e,t,n)},0)},publish:function(e,t,n){var r=this._setEntry(e,"subscriptions"),i=[],s=0,o=r.subscriptions,u=o.length,a=r.receivers,f;for(;s<u;s++)f=o[s],f.type===t&&i.push(f);u=i.length;for(s=0;s<u;s++)i[s].fn(n);(!a||!a.length&&!o.length)&&this._clearEntry(e);if(!a)return;u=a.length;for(s=0;s<u;s++)this.publish(a[s],t,n)},inform:function(e,t){if(!e||!t)return!1;var n=this._setEntry(e,"receivers");return n.receivers.push(t),!0},conceal:function(e,t){if(!e||!t)return!1;var n=this._getEntryProp(e,"receivers");if(!n)return!1;var r=n.length,i=!1,s;while(--r>=0)s=n[r],s===t&&(n.splice(r,1),i=!0);return n.length||this._clearEntry(e),i}};typeof module!="undefined"&&module.exports?module.exports=i:typeof define=="function"&&define.amd?define("lib/rikschennink/utils/Observer",[],function(){return i}):e.Observer=i}(this),function(e,t){"use strict";var n=function(){this._thens=[]};n.prototype={then:function(e,t){this._thens.push({resolve:e,reject:t})},resolve:function(e){this._complete("resolve",e)},reject:function(e){this._complete("reject",e)},_complete:function(e,t){this.then=e==="resolve"?function(e,n){e(t)}:function(e,n){n(t)},this.resolve=this.reject=function(){throw new Error("Promise already completed.")};var n,r=0;while(n=this._thens[r++])n[e]&&n[e](t);delete this._thens}},typeof module!="undefined"&&module.exports?module.exports=n:typeof define=="function"&&define.amd?define("lib/rikschennink/utils/Promise",[],function(){return n}):e.Promise=n}(this),function(e,t){"use strict";var n=e.document?e.document.body:null,r;n&&n.compareDocumentPosition?r=function(e,t){return!!(e.compareDocumentPosition(t)&16)}:n&&n.contains?r=function(e,t){return e!=t&&e.contains(t)}:r=function(e,t){var n=t.parentNode;while(n){if(n===e)return!0;n=n.parentNode}return!1},typeof module!="undefined"&&module.exports?module.exports=r:typeof define=="function"&&define.amd?define("lib/rikschennink/utils/contains",[],function(){return r}):e.contains=r}(this),function(e,t){"use strict";var n=null,r=null,i=e.document?e.document.body:null;!i||i.matches?r="matches":(i.webkitMatchesSelector?r="webkit":i.mozMatchesSelector?r="moz":i.msMatchesSelector?r="ms":i.oMatchesSelector&&(r="o"),r+="MatchesSelector"),r?n=function(e,t){return e[r](t)}:n=function(t,n){var r=(t.parentNode||e.document).querySelectorAll(n)||[],i=r.length;while(i--)if(r[i]==t)return!0;return!1},typeof module!="undefined"&&module.exports?module.exports=n:typeof define=="function"&&define.amd?define("lib/rikschennink/utils/matchesSelector",[],function(){return n}):e.matchesSelector=n}(this),function(e,t){"use strict";var n=function(e,t){var r=Array.isArray(t),i=r&&[]||{};return t=t||{},r?i=t.concat():(e&&typeof e=="object"&&Object.keys(e).forEach(function(t){i[t]=e[t]}),Object.keys(t).forEach(function(r){typeof t[r]!="object"||!t[r]?i[r]=t[r]:e[r]?i[r]=n(e[r],t[r]):i[r]=t[r]})),i};typeof module!="undefined"&&module.exports?module.exports=n:typeof define=="function"&&define.amd?define("lib/rikschennink/utils/mergeObjects",[],function(){return n}):e.mergeObjects=n}(this),function(e,t){"use strict";var n=function(t,n,r,i,s,o){var u,a,f,l=function(t,n){this._path=t,this._expected=n,this._watches=[],this._count=0,this._monitor=null};l.prototype={getPath:function(){return this._path},getExpected:function(){return this._expected},isTrue:function(){var e=0,t=this._count;for(;e<t;e++)if(!this._watches[e].valid)return!1;return!0},assignMonitor:function(e){this._monitor=e},assignWatches:function(e){this._watches=e,this._count=e.length},getMonitor:function(){return this._monitor},getWatches:function(){return this._watches},toString:function(){return this._path+":{"+this._expected+"}"}};var c=function(t,n){this._expression=t,this._change=n,this._currentState=null};c.prototype={evaluate:function(){var e=this._expression.isTrue();e!=this._currentState&&(this._currentState=e,this._change(e))}};var h=function(){this._uid=1,this._db=[],this._expressions=[]};h.prototype={_parse:function(e,t){if(this._expressions[e])return this._expressions[e];var n=0,r=e.split(","),i=r.length,s=[],o,u,a;for(;n<i;n++)o=r[n].split(":"),u=o[0].indexOf("was ")===0,a=u?o[0].substr(4):o[0],s.push({retain:u,test:a,value:t?a:typeof o[1]=="undefined"?!0:o[1]});return this._expressions[e]=s,s},_mergeData:function(e,t,n){return o({element:n,expected:t},e)},create:function(e,t){var n=new r,i=e.getPath(),s=e.getExpected(),o=this;return u.loader.require([u.paths.monitors+i],function(r){var u=0,a=o._db[i],f=r.unload?o._uid++:i,l,c,h,p,d,v,m,g;if(!a){a={watches:[],change:function(e){u=0,l=a.watches.length;for(;u<l;u++)a.watches[u].test(e)}},m=r.unload?o._mergeData(r.data,s,t):r.data,typeof r.unload=="function"&&(a.unload=function(e){return function(){r.unload(e)}}(m));if(typeof r.trigger=="function")r.trigger(a.change,m);else for(d in r.trigger){if(!r.trigger.hasOwnProperty(d))continue;r.trigger[d].addEventListener(d,a.change,!1)}o._db[f]=a}e.assignMonitor(f),h=[],g=typeof r.test=="function",p=r.parse?r.parse(s,g):o._parse(s,g),l=p.length;for(;u<l;u++)v=p[u],c={changed:null,retain:v.retain,retained:null,valid:null,data:r.unload?m:o._mergeData(r.data,v.value,t),test:function(e){if(!e)throw new Error('Conditioner: Test "'+v.test+'" not found on "'+i+'" Monitor.');return function(t){if(this.retained)return;var n=e(this.data,t);this.valid!=n&&(this.valid=n,this.changed&&this.changed()),this.valid&&this.retain&&(this.retained=!0)}}(g?r.test:r.test[v.test])},c.test(),h.push(c);a.watches=a.watches.concat(h),n.resolve(h)}),n},destroy:function(e){var t=e.getMonitor(),n=this._db[t],r=n.watches,i=r.length,s;e.getWatches().forEach(function(e){for(s=0;s<i;s++)r[s]===e&&r.splice(s,1)}),n.unload&&(n.unload(),this._db[t]=null)}};var p=function(t,n,r){var i=g.parse(t);this._element=n,this._tests=i.getTests(),this._condition=new c(i,r),this._conditionChangeBind=this._condition.evaluate.bind(this._condition),this._load()};p.prototype={_load:function(){var e=0,t=this._tests.length;for(;e<t;e++)this._setupMonitorForTest(this._tests[e])},_setupMonitorForTest:function(e){var t=this,n=0,r;a.create(e,this._element).then(function(i){e.assignWatches(i),r=i.length;for(;n<r;n++)i[n].changed=t._conditionChangeBind;t._condition.evaluate()})},destroy:function(){var e=0,t=this._tests.length;for(;e<t;e++)a.destroy(this._tests[e]);this._conditionChangeBind=null}};var d={_uid:0,_db:[],clearTest:function(e){var t=this._db[e];if(!t)return!1;this._db[e]=null,t.destroy()},setTest:function(e,t,n){var r=this._uid++;return this._db[r]=new p(e,t,n),r}},v=function(t,n){this._expression=t,this._negate=typeof n=="undefined"?!1:n};v.prototype={isTrue:function(){return this._expression.isTrue()!==this._negate},getTests:function(){return this._expression instanceof l?[this._expression]:this._expression.getTests()},toString:function(){return(this._negate?"not ":"")+this._expression.toString()}};var m=function(t,n,r){this._a=t,this._operator=n,this._b=r};m.prototype={isTrue:function(){return this._operator==="and"?this._a.isTrue()&&this._b.isTrue():this._a.isTrue()||this._b.isTrue()},getTests:function(){return this._a.getTests().concat(this._b.getTests())},toString:function(){return"("+this._a.toString()+" "+this._operator+" "+this._b.toString()+")"}};var g=function(e,t){return{validate:function(e){if(!e)return!1;var t=new RegExp("[a-z]+:{[^}]*}","g"),n=e.match(t);if(!n||!n.length)return!1;var r=e.replace(t,"");if(r.length&&r.replace(/(not|or|and| |\)|\()/g,"").length)return!1;var i=(e.match(/[{}]/g)||[]).length;return n.length*2===i},parse:function(n){var r=0,i="",s=[],o="",u=!1,a=!1,f=null,c=null,h=[],p=n.length,d,v,m,g,y,b,w,E,S,x,T;f||(f=s);if(!n||!this.validate(n))throw new Error('Expressionparser.parse(expression): "expression" is invalid.');for(;r<p;r++){b=n.charCodeAt(r);if(b===123){a=!0,i="",w=r-2;while(w>=0){E=n.charCodeAt(w);if(E===32||E===40)break;i=n.charAt(w)+i,w--}continue}b===125&&(d=f.length-1,v=d+1,u=f[d]==="not",v=u?d:d+1,g=new l(i,o),f[v]=new e(g,u),i="",o="",u=!1,a=!1);if(a){o+=n.charAt(r);continue}b===40&&(f.push([]),h.push(f),f=f[f.length-1]);if(b===32||r===0||b===40){m=n.substr(r,5).match(/and |or |not /g);if(!m)continue;S=m[0],x=S.length-1,f.push(S.substring(0,x)),r+=x}if(b===41||r===p-1)do{c=h.pop();if(f.length===0){f=c;continue}y=0,T=f.length;for(;y<T;y++){if(typeof f[y]!="string")continue;f[y]==="not"?(f.splice(y,2,new e(f[y+1],!0)),y=-1,T=f.length):f[y+1]!=="not"&&(f.splice(y-1,3,new t(f[y-1],f[y],f[y+1])),y=-1,T=f.length)}f.length===1&&c&&(c[c.length-1]=f[0],f=c)}while(r===p-1&&c)}return s.length===1?s[0]:s}}}(v,m),y={init:function(e){e()},allowsActivation:function(){return!0},destroy:function(){}},b=function(t,n){if(typeof t!="string"||!t.length)return;this._conditions=t,this._element=n,this._state=!1,this._test=null};b.prototype={init:function(e){var t=this,r=!1;this._test=d.setTest(this._conditions,this._element,function(i){t._state=i,n.publish(t,"change"),r||(r=!0,e())})},allowsActivation:function(){return this._state},destroy:function(){d.clearTest(this._test)}};var w={_options:{},_redirects:{},_enabled:{},registerModule:function(e,t,n,r){this._options[u.loader.toUrl(e)]=t,this._enabled[e]=r,n&&(this._redirects[n]=e),u.loader.config(e,t)},isModuleEnabled:function(e){return this._enabled[e]!==!1},getRedirect:function(e){return this._redirects[e]||e},getModule:function(e){if(!e)throw new Error('ModuleRegistry.getModule(path): "path" is a required parameter.');return this._options[e]||this._options[u.loader.toUrl(e)]}},E=function(t,n,r,i){if(!t||!n)throw new Error('ModuleController(path,element,options,agent): "path" and "element" are required parameters.');this._path=w.getRedirect(t),this._alias=t,this._element=n,this._options=r,this._agent=i||y,this._Module=null,this._module=null,this._initialized=!1,this._onAgentStateChangeBind=this._onAgentStateChange.bind(this);var s=this;this._agent.init(function(){s._initialize()})};E.prototype={hasInitialized:function(){return this._initialized},getElement:function(){return this._element},getModulePath:function(){return this._path},isModuleAvailable:function(){return this._agent.allowsActivation()&&!this._module},isModuleActive:function(){return this._module!==null},wrapsModuleWithPath:function(e){return this._path===e||this._alias===e},_initialize:function(){this._initialized=!0,n.subscribe(this._agent,"change",this._onAgentStateChangeBind),n.publishAsync(this,"init",this),this._agent.allowsActivation()&&this._onBecameAvailable()},_onBecameAvailable:function(){n.publishAsync(this,"available",this),this._load()},_onAgentStateChange:function(){var e=this._agent.allowsActivation();this._module&&!e?this._unload():!this._module&&e&&this._onBecameAvailable()},_load:function(){if(this._Module){this._onLoad();return}var e=this;u.loader.require([this._path],function(t){if(!t)throw new Error("ModuleController: A module needs to export an object.");if(!e._agent)return;e._Module=t,e._onLoad()})},_applyOverrides:function(e,t){if(typeof t=="string"){if(t.charCodeAt(0)!=123){var r=0,i=t.split(", "),s=i.length;for(;r<s;r++)this._overrideObjectWithUri(e,i[r]);return e}try{t=JSON.parse(t)}catch(n){throw new Error('ModuleController.load(): "options" is not a valid JSON string.')}}return o(e,t)},_overrideObjectWithUri:function(e,t){var n=e,r="",i=0,s=t.length,o;while(i<s){o=t.charCodeAt(i);if(o!=46&&o!=58)r+=t.charAt(i);else{if(o==58){n[r]=this._castValueToType(t.substr(i+1));break}n=n[r],r=""}i++}},_castValueToType:function(e){return e.charCodeAt(0)==39?e.substring(1,e.length-1):isNaN(e)?e=="true"||e=="false"?e==="true":e.indexOf(",")!==-1?e.split(",").map(this._castValueToType):e:parseFloat(e)},_parseOptions:function(e,t,n){var r=[],i={},s={},u,a;do u=w.getModule(e),r.push({page:u,module:t.options}),e=t.__superUrl;while(t=t.__super);a=r.length;while(a--)i=o(i,r[a].page),s=o(s,r[a].module);return u=o(s,i),n&&(u=this._applyOverrides(u,n)),u},_onLoad:function(){if(!this._agent.allowsActivation())return;var e=this._parseOptions(this._path,this._Module,this._options);typeof this._Module=="function"?this._module=new this._Module(this._element,e):(this._module=this._Module.load?this._Module.load(this._element,e):null,this._module||(this._module=this._Module));if(!this._module)throw new Error('ModuleController.load(): could not initialize module, missing constructor or "load" method.');n.inform(this._module,this),n.publishAsync(this,"load",this)},_unload:function(){return this._module?(n.conceal(this._module,this),this._module.unload&&this._module.unload(),this._module=null,n.publish(this,"unload",this),!0):!1},destroy:function(){n.unsubscribe(this._agent,"change",this._onAgentStateChangeBind),this._unload(),this._agent.destroy(),this._onAgentStateChangeBind=null},execute:function(e,t){if(!this._module)return{status:404,response:null};var n=this._module[e];if(!n)throw new Error('ModuleController.execute(method,params): function specified in "method" not found on module.');return t=t||[],{status:200,response:n.apply(this._module,t)}}};var S=function(){var e=function(e){return e.isModuleActive()},t=function(e){return e.isModuleAvailable()},r=function(e){return e.getModulePath()},o=function(t,n){if(!t)throw new Error('NodeController(element): "element" is a required parameter.');this._element=t,this._element.setAttribute(u.attr.processed,"true"),this._priority=n?parseInt(n,10):0,this._moduleControllers=[],this._moduleAvailableBind=this._onModuleAvailable.bind(this),this._moduleLoadBind=this._onModuleLoad.bind(this),this._moduleUnloadBind=this._onModuleUnload.bind(this)};return o.hasProcessed=function(e){return e.getAttribute(u.attr.processed)==="true"},o.prototype={load:function(e){if(!e||!e.length)return;this._moduleControllers=e;var t=0,r=this._moduleControllers.length,i;for(;t<r;t++)i=this._moduleControllers[t],n.subscribe(i,"available",this._moduleAvailableBind),n.subscribe(i,"load",this._moduleLoadBind)},destroy:function(){var e=0,t=this._moduleControllers.length;for(;e<t;e++)this._destroyModule(this._moduleControllers[e]);this._moduleAvailableBind=null,this._moduleLoadBind=null,this._moduleUnloadBind=null,this._updateAttribute(u.attr.initialized,this._moduleControllers),this._moduleControllers=null,this._element.removeAttribute(u.attr.processed)},_destroyModule:function(e){n.unsubscribe(e,"available",this._moduleAvailableBind),n.unsubscribe(e,"load",this._moduleLoadBind),n.unsubscribe(e,"unload",this._moduleUnloadBind),n.conceal(e,this),e.destroy()},getPriority:function(){return this._priority},getElement:function(){return this._element},matchesSelector:function(e,t){return!e&&t?i(t,this._element):t&&!i(t,this._element)?!1:s(this._element,e)},areAllModulesActive:function(){return this.getActiveModules().length===this._moduleControllers.length},getActiveModules:function(){return this._moduleControllers.filter(e)},getModule:function(e){return this._getModules(e,!0)},getModules:function(e){return this._getModules(e)},_getModules:function(e,t){if(typeof e=="undefined")return t?this._moduleControllers[0]:this._moduleControllers.concat();var n=0,r=this._moduleControllers.length,i=[],s;for(;n<r;n++){s=this._moduleControllers[n];if(!s.wrapsModuleWithPath(e))continue;if(t)return s;i.push(s)}return t?null:i},execute:function(e,t){return this._moduleControllers.map(function(n){return{controller:n,result:n.execute(e,t)}})},_onModuleAvailable:function(e){n.inform(e,this),this._updateAttribute(u.attr.loading,this._moduleControllers.filter(t))},_onModuleLoad:function(e){n.unsubscribe(e,"load",this._moduleLoadBind),n.subscribe(e,"unload",this._moduleUnloadBind),this._updateAttribute(u.attr.loading,this._moduleControllers.filter(t)),this._updateAttribute(u.attr.initialized,this.getActiveModules())},_onModuleUnload:function(e){n.subscribe(e,"load",this._moduleLoadBind),n.unsubscribe(e,"unload",this._moduleUnloadBind),n.conceal(e,this),this._updateAttribute(u.attr.initialized,this.getActiveModules())},_updateAttribute:function(e,t){var n=t.map(r);n.length?this._element.setAttribute(e,n.join(",")):this._element.removeAttribute(e)}},o}(),x=function(t){if(!t||!t.splice)throw new Error("SyncedControllerGroup(controllers): Expects an array of node controllers as parameters.");this._inSync=!1,this._controllers=t,this._controllerLoadedBind=this._onLoad.bind(this),this._controllerUnloadedBind=this._onUnload.bind(this);var r=0,i=this._controllers.length,s;for(;r<i;r++){s=this._controllers[r];if(!s)throw this.destroy(),new Error("SyncedControllerGroup(controllers): Stumbled upon an undefined controller");n.subscribe(s,"load",this._controllerLoadedBind),n.subscribe(s,"unload",this._controllerUnloadedBind)}this._test()};x.prototype={destroy:function(){var e=0,t=this._controllers.length,r;for(;e<t;e++){r=this._controllers[e];if(!r)continue;n.unsubscribe(r,"load",this._controllerLoadedBind),n.unsubscribe(r,"unload",this._controllerUnloadedBind)}this._controllerLoadedBind=null,this._controllerUnloadedBind=null,this._controllers=null},areAllModulesActive:function(){var e=0,t=this._controllers.length,n;for(;e<t;e++){n=this._controllers[e];if(!this._isActiveController(n))return!1}return!0},_onLoad:function(){this._test()},_onUnload:function(){this._unload()},_isActiveController:function(e){return e.isModuleActive&&e.isModuleActive()||e.areAllModulesActive&&e.areAllModulesActive()},_test:function(){if(!this.areAllModulesActive())return;this._load()},_load:function(){if(this._inSync)return;this._inSync=!0,n.publishAsync(this,"load",this._controllers)},_unload:function(){if(!this._inSync)return;this._inSync=!1,n.publish(this,"unload",this._controllers)}};var T=new RegExp("^\\[\\s*{","gm"),N=function(){this._nodes=[]};return N.prototype={parse:function(e){if(!e)throw new Error('ModuleLoader.loadModules(context): "context" is a required parameter.');var t=e.querySelectorAll("[data-module]"),n=t.length,r=0,i=[],s,o;if(!t)return[];for(;r<n;r++){o=t[r];if(S.hasProcessed(o))continue;i.push(new S(o,o.getAttribute(u.attr.priority)))}i.sort(function(e,t){return e.getPriority()-t.getPriority()}),r=i.length;while(--r>=0)s=i[r],s.load.call(s,this._getModuleControllersByElement(s.getElement()));return this._nodes=this._nodes.concat(i),i},load:function(e,t){if(!t)throw new Error('ModuleLoader.load(element,controllers): "controllers" is a required parameter.');t=t.length?t:[t];var n=0,r=t.length,i=[],s,o;o=new S(e);for(;n<r;n++)s=t[n],i.push(this._getModuleController(s.path,e,s.options,s.conditions));return o.load(i),this._nodes.push(o),o},getNodeByElement:function(e){var t=0,n=this._nodes.length,r;for(;t<n;t++){r=this._nodes[t];if(r.getElement()===e)return r}return null},getNodes:function(e,t,n){if(typeof e=="undefined"&&typeof t=="undefined")return n?this._nodes[0]:this._nodes.concat();var r=0,i=this._nodes.length,s=[],o;for(;r<i;r++){o=this._nodes[r];if(o.matchesSelector(e,t)){if(n)return o;s.push(o)}}return n?null:s},destroy:function(e){var t=e.length,n=0,r;while(t--){r=this._nodes.indexOf(e[t]);if(r===-1)continue;this._nodes.splice(r,1),e[t].destroy(),n++}return e.length===n},_getModuleControllersByElement:function(e){var t=e.getAttribute(u.attr.module)||"";if(t.charCodeAt(0)==91){var n=[],r=0,i,s,o;try{s=JSON.parse(t)}catch(a){throw new Error('ModuleLoader.load(context): "data-module" attribute contains a malformed JSON string.')}if(!s)return[];i=s.length;if(T.test(t)){for(;r<i;r++){o=s[r];if(!w.isModuleEnabled(o.path))continue;n[r]=this._getModuleController(o.path,e,o.options,o.conditions)}return n}for(;r<i;r++){o=s[r];if(!w.isModuleEnabled(typeof o=="string"?o:o[0]))continue;typeof o=="string"?n[r]=this._getModuleController(o,e):n[r]=this._getModuleController(o[0],e,typeof o[1]=="string"?o[2]:o[1],typeof o[1]=="string"?o[1]:o[2])}return n}return w.isModuleEnabled(t)?[this._getModuleController(t,e,e.getAttribute(u.attr.options),e.getAttribute(u.attr.conditions))]:null},_getModuleController:function(e,t,n,r){return new E(e,t,n,r?new b(r,t):y)}},u={paths:{monitors:"./monitors/"},attr:{options:"data-options",module:"data-module",conditions:"data-conditions",priority:"data-priority",initialized:"data-initialized",processed:"data-processed",loading:"data-loading"},loader:{require:function(e,n){t(e,n)},config:function(e,t){var n={};n[e]=t,requirejs.config({config:n})},toUrl:function(e){return requirejs.toUrl(e)}},modules:{}},a=new h,f=new N,{init:function(t){return t&&this.setOptions(t),f.parse(e.document)},setOptions:function(e){if(!e)throw new Error('Conditioner.setOptions(options): "options" is a required parameter.');var t,n,r,i,s;u=o(u,e);for(n in u.paths){if(!u.paths.hasOwnProperty(n))continue;u.paths[n]+=u.paths[n].slice(-1)!=="/"?"/":""}for(n in u.modules){if(!u.modules.hasOwnProperty(n))continue;r=u.modules[n],i=typeof r=="string"?r:r.alias,t=typeof r=="string"?null:r.options||{},s=typeof r=="string"?null:r.enabled,w.registerModule(n,t,i,s)}},parse:function(e){if(!e)throw new Error('Conditioner.parse(context): "context" is a required parameter.');return f.parse(e)},load:function(e,t){return f.load(e,t)},sync:function(){var e=Object.create(x.prototype);return x.apply(e,[arguments[0].slice?arguments[0]:Array.prototype.slice.call(arguments,0)]),e},getNode:function(){return typeof arguments[0]=="object"?f.getNodeByElement(arguments[0]):f.getNodes(arguments[0],arguments[1],!0)},getNodes:function(e,t){return f.getNodes(e,t,!1)},destroy:function(){var e=[],t=arguments[0];if(!t)throw new Error("Conditioner.destroy(...): A DOM node, Array, String or NodeController is required as the first argument.");return Array.isArray(t)&&(e=t),typeof t=="string"?e=f.getNodes(t,arguments[1]):t instanceof S?e.push(t):t.nodeName&&(e=f.getNodes().filter(function(e){return i(t,e.getElement())})),e.length===0?!1:f.destroy(e)},getModule:function(){var e,t,n,r,i,s,o,u;if(typeof arguments[0]=="object")return o=f.getNodeByElement(arguments[0]),o?o.getModule(arguments[1]):null;t=arguments[0],typeof arguments[1]=="string"?(n=arguments[1],r=arguments[2]):r=arguments[1],e=0,i=f.getNodes(n,r,!1),s=i.length;for(;e<s;e++){u=i[e].getModule(t);if(u)return u}return null},getModules:function(){var e,t,n,r,i,s,o,u,a;if(typeof arguments[0]=="object")return o=f.getNodeByElement(arguments[0]),o.getModules(arguments[1]);t=arguments[0],typeof arguments[1]=="string"?(n=arguments[1],r=arguments[2]):r=arguments[1],e=0,i=this.getNodes(n,r),s=i.length,a=[];for(;e<s;e++)u=i[e].getModules(t),u.length&&(a=a.concat(u));return a},is:function(e,t){if(!e)throw new Error('Conditioner.is(condition,[element]): "condition" is a required parameter.');var n=new r;return d.setTest(e,t,function(e){n.resolve(e)}),n},on:function(e,t,n){if(!e)throw new Error('Conditioner.on(condition,[element],callback): "condition" and "callback" are required parameter.');n=typeof t=="function"?t:n,d.setTest(e,t,function(e){n(e)})}}};if(typeof module!="undefined"&&module.exports)module.exports=n(require,require("./utils/Observer"),require("./utils/Promise"),require("./utils/contains"),require("./utils/matchesSelector"),require("./utils/mergeObjects"));else{if(typeof define!="function"||!define.amd)throw new Error("To use ConditionerJS you need to setup an AMD module loader or use something like Browserify.");define("lib/rikschennink/conditioner",["require","./utils/Observer","./utils/Promise","./utils/contains","./utils/matchesSelector","./utils/mergeObjects"],n)}}(this),require.config({map:{"*":{conditioner:"lib/rikschennink/conditioner","utils/Observer":"lib/rikschennink/utils/Observer","utils/mergeObjects":"lib/rikschennink/utils/mergeObjects"}},shim:{"lib/rikschennink/conditioner":["shim/DOMContentLoaded","shim/addEventListener","shim/Array.forEach","shim/Array.filter","shim/Array.map","shim/Array.indexOf","shim/Array.isArray","shim/Function.bind","shim/Object.create","shim/Object.keys"],"lib/rikschennink/monitors/media":["shim/matchMedia","shim/matchMedia.addListener"]}}),require(["conditioner"],function(e){e.init({modules:{"ui/StarGazers":{options:{width:90,user:"rikschennink",repo:"conditioner"}},"ui/StorageConsentSelect":{options:{label:{level:{incognito:"Incognito"}}}},"security/StorageConsentGuard":{options:{levels:["all","incognito","none"],initial:"none"}}}})}),define("main",function(){}),define("security/StorageConsentGuard",["utils/Observer","utils/mergeObjects","module"],function(e,t,n){"use strict";var r=function(){this._level=null,this.setOptions(n.config()),this._setDefaultLevel()};r.prototype={setOptions:function(e){e||(e={}),this._options=t({initial:"all",levels:["all","none"]},e),this._setDefaultLevel()},_setDefaultLevel:function(){this.setActiveLevel(this._options.initial)},getLevels:function(){return this._options.levels},getActiveLevel:function(){return this._level},setActiveLevel:function(t){if(t===this._level)return;this._level=t,e.publish(this,"change",this._level)}};var i;return{getInstance:function(){return i||(i=new r),i}}}),function(){var e=function(e,t){var n="";return{trigger:function(r){var i=t.getInstance();e.subscribe(i,"change",function(){n=i.getActiveLevel(),r()}),n=i.getActiveLevel()},parse:function(e){return[{value:e.split(",")}]},test:function(e){return e.expected.indexOf(n)!=-1}}};typeof module!="undefined"&&module.exports?module.exports=e(require("../utils/Observer"),require("security/StorageConsentGuard")):typeof define=="function"&&define.amd&&define("lib/rikschennink/monitors/cookies",["../utils/Observer","security/StorageConsentGuard"],function(t,n){return e(t,n)})}(),function(e,t){"use strict";var n={trigger:{online:e,offline:e},test:{any:function(e){return e.expected}}};typeof module!="undefined"&&module.exports?module.exports=n:typeof define=="function"&&define.amd&&define("lib/rikschennink/monitors/connection",[],function(){return n})}(this),function(e,t){"use strict";var n=function(t){var n=e.innerHeight,r=t.getBoundingClientRect();return r.top>0&&r.top<n||r.bottom>0&&r.bottom<n},r=function(e){return parseInt(e,10)},i={trigger:{resize:e,scroll:e},test:{visible:function(e){return e.seen=n(e.element),e.seen&&e.expected},"min-width":function(e){return r(e.expected)<=e.element.offsetWidth},"max-width":function(e){return r(e.expected)>=e.element.offsetWidth},"min-height":function(e){return r(e.expected)<=e.element.offsetHeight},"max-height":function(e){return r(e.expected)>=e.element.offsetHeight}}};typeof module!="undefined"&&module.exports?module.exports=i:typeof define=="function"&&define.amd&&define("lib/rikschennink/monitors/element",[],function(){return i})}(this),window.addEventListener&&(window.matchMedia=window.matchMedia||function(e,t){"use strict";var n,r=e.documentElement,i=r.firstElementChild||r.firstChild,s=e.createElement("body"),o=e.createElement("div");return o.id="mq-test-1",o.style.cssText="position:absolute;top:-100em",s.style.background="none",s.appendChild(o),function(e){return o.innerHTML='&shy;<style media="'+e+'"> #mq-test-1 { width: 42px; }</style>',r.insertBefore(s,i),n=o.offsetWidth===42,r.removeChild(s),{matches:n,media:e}}}(document)),define("shim/matchMedia",function(){}),window.addEventListener&&function(){if(!window.matchMedia("(min-width:0)").addListener){var e=window.matchMedia;window.matchMedia=function(t){var n=e(t),r=[],i=!1,s,o=function(){var s=e(t),o=s.matches&&!i,u=!s.matches&&i;if(o||u)for(var a=0,f=r.length;a<f;a++)r[a].call(n,s);i=s.matches};return n.addListener=function(e){r.push(e),s||(s=setInterval(o,1e3))},n.removeListener=function(e){for(var t=0,n=r.length;t<n;t++)r[t]===e&&r.splice(t,1);!r.length&&s&&clearInterval(s)},n}}}(),define("shim/matchMedia.addListener",function(){}),function(e,t){"use strict";var n={data:{mql:null},trigger:function(t,n){if(n.expected==="supported")return;n.change=function(){t()},n.mql=e.matchMedia(n.expected),n.mql.addListener(n.change)},parse:function(e){var t=[];return e==="supported"?t.push({test:"supported",value:!0}):t.push({test:"query",value:e}),t},test:{supported:function(){return"matchMedia"in e},query:function(e){return e.mql.matches}},unload:function(e){e.mql.removeListener(e.change)}};typeof module!="undefined"&&module.exports?module.exports=n:typeof define=="function"&&define.amd&&define("lib/rikschennink/monitors/media",[],function(){return n})}(this),function(e,t){"use strict";var n=e.document,r=n.documentElement||n.body.parentNode||n.body,i=function(){return e.pageXOffset!==t?e.pageXOffset:r.scrollLeft},s=function(){return e.pageYOffset!==t?e.pageYOffset:r.scrollTop},o=function(e,t){if(!t)return;var n=e.getBoundingClientRect(),r=t.pageX-i(),o=t.pageY-s(),u,a;return r<n.left?u=n.left:r>n.right?u=n.right:u=r,o<n.top?a=n.top:o>n.bottom?a=n.bottom:a=o,u===r&&a===o?0:Math.pow(r-u,2)+Math.pow(o-a,2)},u=e.PointerEvent||e.MSPointerEvent,a=e.PointerEvent?"pointermove":"MSPointerMove",f={available:!1,moves:0,movesRequired:2},l={trigger:function(e){var t=function r(t){if(u){f.available=t.pointerType===4||t.pointerType===3;if(!f.available)return;n.removeEventListener(a,r,!1),e();return}if(t.type!=="mousemove"){f.moves=0;return}++f.moves>=f.movesRequired&&(n.removeEventListener("mousemove",r,!1),n.removeEventListener("mousedown",r,!1),f.available=!0,e())};u?n.addEventListener(a,t,!1):(n.addEventListener("mousemove",t,!1),n.addEventListener("mousedown",t,!1)),n.addEventListener("mousemove",function(t){e(t)},!1)},test:{near:function(e,t){if(!f.available)return!1;var n=e.expected===!0?50:parseInt(e.expected,10);return n*n>=o(e.element,t)},fine:function(e){return f.available===e.expected}}};typeof module!="undefined"&&module.exports?module.exports=l:typeof define=="function"&&define.amd&&define("lib/rikschennink/monitors/pointer",[],function(){return l})}(this),function(e,t){"use strict";var n=e.document,r=function(){return e.innerWidth||n.documentElement.clientWidth},i=function(){return e.innerHeight||n.documentElement.clientHeight},s=function(e){return parseInt(e,10)},o={trigger:{resize:e},test:{"min-width":function(e){return s(e.expected)<=r()},"max-width":function(e){return s(e.expected)>=r()},"min-height":function(e){return s(e.expected)<=i()},"max-height":function(e){return s(e.expected)>=i()}}};typeof module!="undefined"&&module.exports?module.exports=o:typeof define=="function"&&define.amd&&define("lib/rikschennink/monitors/window",[],function(){return o})}(this),define("ui/Clock",[],function(){"use strict";var e=function(e){return e<10?"0"+e:e},t=function(e,t){this._element=e,this._options=t,this._time=document.createElement("p"),this._tick(),this._element.appendChild(this._time)};return t.options={time:!0},t.prototype={_tick:function(){var t=this,n=new Date,r=e(n.getDate())+"/"+(n.getMonth()+1)+"/"+n.getFullYear(),i=e(n.getHours())+":"+e(n.getMinutes())+":"+e(n.getSeconds());this._time.textContent=r+(this._options.time?" - "+i:"");if(!this._options.time)return;this._timer=setTimeout(function(){t._tick()},900)},unload:function(){clearTimeout(this._timer),this._time.parentNode.removeChild(this._time)}},t}),define("ui/Zoom",[],function(){"use strict";var e=function(e,t){this._element=e,this._options=t,this._btn=document.createElement("button"),this._btn.textContent="zoom in",this._btn.addEventListener("click",this,!1),this._element.appendChild(this._btn)};return e.options={fontSize:"2em"},e.prototype={handleEvent:function(e){e.type==="click"&&(this._element.style.fontSize?this._zoomOut():this._zoomIn())},_zoomIn:function(){this._btn.textContent="zoom out",this._element.style.fontSize=this._options.fontSize},_zoomOut:function(){this._btn.textContent="zoom in",this._element.style.fontSize=null},unload:function(){this._zoomOut(),this._btn.removeEventListener("click",this,!1),this._btn.parentNode.removeChild(this._btn)}},e}),define("ui/StorageConsentSelect",["security/StorageConsentGuard"],function(e){"use strict";var t=function(t,n){this._element=t,this._options=n,this._storageGuard=e.getInstance(),this._inner=this._element.innerHTML;var r,i=this._options.label.level,s="";for(r in i){if(!i.hasOwnProperty(r))continue;s+="<option"+(r==this._storageGuard.getActiveLevel()?' selected="selected"':"")+' value="'+r+'">'+this._options.label.level[r]+"</option>"}this._element.innerHTML='<label for="storage-consent">'+this._options.label.select+"</label>"+'<select id="storage-consent">'+s+"</select>",this._element.querySelector("select").addEventListener("change",this)};return t.options={label:{select:"Cookies",level:{all:"All",none:"None"}}},t.prototype={handleEvent:function(e){if(e.type==="change"){var t=this._element.querySelector("select"),n=t.options[t.selectedIndex].value;this._storageGuard.setActiveLevel(n)}},unload:function(){this._element.querySelector("select").removeEventListener("change",this),this._element.innerHTML=this._inner,this._storageGuard=null}},t}),define("ui/StarGazers",[],function(){"use strict";var e=function(e,t){this._element=e,this._options=t,this._inner=this._element.innerHTML,this._load()};return e.options={user:"mdo",repo:"github-buttons",width:80,height:20,count:!0,type:"watch"},e.prototype={_load:function(){this._element.innerHTML='<iframe src="http://ghbtns.com/github-btn.html?user='+this._options.user+"&repo="+this._options.repo+"&type="+this._options.type+"&count="+this._options.count+'"'+'allowtransparency="true" '+'frameborder="0" '+'scrolling="0" '+'width="'+this._options.width+'" '+'height="'+this._options.height+'"></iframe>'},unload:function(){this._element.innerHTML=this._inner}},e});